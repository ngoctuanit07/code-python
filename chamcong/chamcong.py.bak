import pandas as pd

def read_data_from_excel(excel_file_path, sheet_name=0):
    """
    Đọc dữ liệu từ file Excel dựa trên TenMay.
    """
   
    df = pd.read_excel(excel_file_path, sheet_name=sheet_name)
    print(f"Cac cot co trong file: {df.columns.tolist()}")  

    
    if 'TenMay' in df.columns:
        # Lọc dữ liệu dựa trên TenMay
        filtered_df = df[df['TenMay'] == 'Máy MCC00002']
        print(f"So hang sau khi loc: {len(filtered_df)}") 

        # Chọn các cột cần thiết
        if all(col in df.columns for col in ['MaChamCong', 'NgayCham', 'GioCham']):
            rows = filtered_df[['MaChamCong', 'NgayCham', 'GioCham']].values.tolist()
            return rows
        else:
            print("kiem tra file.")
    else:
        print("Cot 'TenMay' khong ton tai.")
    return []

# Gọi hàm với đường dẫn file Excel của bạn
excel_file_path = 'D:\\tools\\dv\\chamcong\\CheckInOut.xlsx'
rows = read_data_from_excel(excel_file_path)
print(rows)  # In ra kết quả để debug
